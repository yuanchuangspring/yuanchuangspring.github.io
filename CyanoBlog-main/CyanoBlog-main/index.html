<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>CyanoBlog</title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/index.css"></link>
    <link rel="stylesheet" type="text/css" href="css/prism.css"></link>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="./js/prism.js"></script>
    
    
    <style>
        [v-cloak]{
            display:none;
        }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-md bg-dark navbar-dark">
      <!-- Brand -->
      <div class="container">
        <a class="navbar-brand" href="your blog url">CyanoBlog</a>
      
        <!-- Toggler/collapsibe Button -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
      <!-- Navbar links -->
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li> 
        </ul>
      </div> 
    </nav>
    <br>
    
    <!-- Contents -->
    <div class="container" id="blogmain">
       <div class="card">
           <div class="card-body">
               <center>欢迎来到CyanoBlog🎊</center>
               <center>这里是我敲代码的地方!</center>
               <center>这里汇集了一些乱七八糟的东西💻</center>
           </div>
       </div>
       
       <br>
       
       <div class="container">
       <div class="input-group input-group-sm" id="searchgroup">
         <input id="sinput" class="form-control" type="search" placeholder="搜索文章" />
         <button class="btn btn-primary" @click="search()">搜索</button>
       </div></div>
       
       <br>
       
      <!--loading-->
      <center v-show="!ifloaded">
      <div class="spinner-border"></div>
      <div>加载中</div>
      </center>
       <!-- blogs -->
       <div id="mainblog" v-show="ifloaded&&blog.ifshow" v-for="(blog,index) in maindata"  v-cloak>
       <div class="card">
           <div class="card-body">
            <a :href="'javascript:goto('+blog.id+')'"><b>{{blog.title}}</b></a>
            <br>
            <div class="blog-time">{{blog.time}}</div>
            
            <div class="blog-general">摘要:{{blog.general}}</div>
           </div>
           <div class="card-footer">
           <div class="row">
                <div class="blog-info">👁{{blog.read}}&nbsp;&nbsp;<a :href="'javascript:addstar('+index+')'">⭐️{{blog.star}}</a></div>
           </div>
           </div>
       </div>
       <br>
       </div>
       <!-- blog end-->
    </div>
    <script>
        const HelloVueApp = {
            data() {
                return {
                    test: 'Hello',
                    maindata:"",
                    ifloaded:false,
                    ifloaded1:true
                }
            },
            methods:{
                search:function (){
                    keyword=$("#sinput").val();
                    for(b=0;b<this.maindata.length;b++){
                        this.maindata[b]["ifshow"]=false;
                        if (this.maindata[b]["title"].indexOf(keyword)!=-1||this.maindata[b]["general"].indexOf(keyword)!=-1){
                            this.maindata[b]["ifshow"]=true;
                        }
                        
                    }
                    $("#searchgroup").append('<button class="btn btn-danger" onclick="app.csearch()">取消</button>');
                },
                csearch:function (){
                                alert(1)
                                    
                        }
            },
            mounted () {
                $.get(
                    "./php/main.php?action=getdata",
                    function(res){
                         app.$data.maindata=JSON.parse(res)
                         for(a=0;a<app.$data.maindata.length;a++){
                             app.$data.maindata[a]["ifshow"]=true;
                         }
                         app.$data.ifloaded=true
                         app.$data.ifloaded1=false
                    }
                )
        
            }
        }
        var app = Vue.createApp(HelloVueApp).mount('#blogmain')
        function goto(id){
            $.get("php/main.php?action=addread&id="+id);
            window.location.href="save/"+id+".html";
        }
        function addstar(id){
                    $.get(
                        "php/main.php?action=addstar&id="+app.$data.maindata[id]["id"],
                        function(result){
                            
                        }
                    );
                    app.$data.maindata[id]["star"]=parseInt(app.$data.maindata[id]["star"])+1;
        }
        
        
    </script>
  </body>
  
</html>